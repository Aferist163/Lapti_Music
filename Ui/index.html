<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>Lapti Music</title>
  <link rel="stylesheet" href="style.css">
</head>

<body>
  <h1>Lapti Music</h1>

  <input id="query" type="text" placeholder="–í–≤–µ–¥–∏ –Ω–∞–∑–≤—É –ø—ñ—Å–Ω—ñ" />
  <button onclick="search()">üîç –ü–æ—à—É–∫</button>

  <p id="result-name"></p>
  <audio id="player" controls></audio>

  <script>
    async function search() {
      const query = document.getElementById("query").value;
      if (!query) return;

      const url = `https://api.deezer.com/search?q=${encodeURIComponent(query)}&output=jsonp`;

      // Deezer API –ø—Ä–∞—Ü—é—î —Ç—ñ–ª—å–∫–∏ —á–µ—Ä–µ–∑ JSONP
      const script = document.createElement('script');
      const callbackName = 'jsonp_callback_' + Math.round(100000 * Math.random());

      window[callbackName] = function (data) {
        delete window[callbackName];
        document.body.removeChild(script);

        if (data.data.length > 0) {
          const track = data.data[0]; // –±–µ—Ä–µ–º–æ –ø–µ—Ä—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
          document.getElementById("result-name").innerText = track.title + " ‚Äî " + track.artist.name;
          const player = document.getElementById("player");
          player.src = track.preview;
          player.play();
        } else {
          document.getElementById("result-name").innerText = "–ù—ñ—á–æ–≥–æ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ üò¢";
        }
      };

      script.src = url + `&callback=${callbackName}`;
      document.body.appendChild(script);
    }
  </script>
</body>

</html>